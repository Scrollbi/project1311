<Window x:Class="project2.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Товары" Height="600" Width="1200">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>


        <StackPanel Grid.Row="0" Orientation="Horizontal" Background="LightBlue">
            <TextBlock x:Name="txtUser" Text="Пользователь: " VerticalAlignment="Center" Margin="0,0,10,0"/>
            <Button Content="Выйти" Click="BtnLogout_Click"/>
        </StackPanel>


        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="10">
            <TextBlock Text="Поиск:" VerticalAlignment="Center" Margin="0,0,5,0"/>
            <TextBox x:Name="txtSearch" Width="200" TextChanged="txtSearch_TextChanged"/>

            <TextBlock Text="Производитель:" VerticalAlignment="Center" Margin="20,0,5,0"/>
            <ComboBox x:Name="cmbManufacturer" Width="150" SelectionChanged="cmbManufacturer_SelectionChanged"/>

            <Button Content="Сортировка" Click="btnSort_Click" Margin="20,0,0,0"/>
            <Button Content="Обновить" Click="BtnRefresh_Click" Margin="10,0,0,0"/>
            <Button Content="Изменить фото" Click="BtnChangeImage_Click" Margin="10,0,0,0"/>

            
            <Button Content="Добавить товар" Click="BtnAddProduct_Click" Margin="10,0,0,0"/>
            <Button Content="Редактировать товар" Click="BtnEditProduct_Click" Margin="10,0,0,0"/>
            <Button Content="Удалить товар" Click="BtnDeleteProduct_Click" Margin="10,0,0,0"/>
        </StackPanel>


        <DataGrid Grid.Row="2" x:Name="productsGrid" AutoGenerateColumns="False" Margin="10"
                  MouseDoubleClick="productsGrid_MouseDoubleClick">

            <DataGrid.Resources>

                <Style x:Key="StrikethroughPriceStyle" TargetType="TextBlock">
                    <Setter Property="Foreground" Value="Black"/>
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding HasAnyDiscount}" Value="True">
                            <Setter Property="TextDecorations" Value="Strikethrough"/>
                            <Setter Property="Foreground" Value="Red"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </DataGrid.Resources>

            <DataGrid.Columns>

                <DataGridTemplateColumn Header="Фото" Width="120">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Border Width="100" Height="80" Background="LightGray" BorderBrush="Gray" BorderThickness="1">
                                <Image Source="{Binding Image}" Stretch="Uniform"/>
                            </Border>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>

                <DataGridTextColumn Header="Название" Binding="{Binding Name}" Width="150"/>
                <DataGridTextColumn Header="Категория" Binding="{Binding Category}" Width="120"/>
                <DataGridTextColumn Header="Производитель" Binding="{Binding Manufacturer}" Width="120"/>


                <DataGridTemplateColumn Header="Цена" Width="80">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Price, StringFormat={}{0:C}}"
                                       Style="{StaticResource StrikethroughPriceStyle}"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>


                <DataGridTextColumn Header="Цена со скидкой" 
                                   Binding="{Binding DiscountedPrice, StringFormat={}{0:C}}" 
                                   Width="100"/>

                <DataGridTextColumn Header="Скидка" Binding="{Binding Discount, StringFormat={}{0}%}" Width="60"/>
                <DataGridTextColumn Header="На складе" Binding="{Binding StockQuantity}" Width="80"/>
            </DataGrid.Columns>

            <DataGrid.RowStyle>
                <Style TargetType="DataGridRow">
                    <Style.Triggers>

                        <DataTrigger Binding="{Binding HasHighDiscount}" Value="True">
                            <Setter Property="Background" Value="#2E8B57"/>
                            <Setter Property="Foreground" Value="White"/>
                        </DataTrigger>


                        <DataTrigger Binding="{Binding IsOutOfStock}" Value="True">
                            <Setter Property="Background" Value="#ADD8E6"/>
                            <Setter Property="Foreground" Value="Black"/>
                        </DataTrigger>


                        <MultiDataTrigger>
                            <MultiDataTrigger.Conditions>
                                <Condition Binding="{Binding HasAnyDiscount}" Value="True"/>
                                <Condition Binding="{Binding HasHighDiscount}" Value="False"/>
                            </MultiDataTrigger.Conditions>
                            <Setter Property="Foreground" Value="Red"/>
                        </MultiDataTrigger>
                    </Style.Triggers>
                </Style>
            </DataGrid.RowStyle>
        </DataGrid>
    </Grid>
</Window>